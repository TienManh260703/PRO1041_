CREATE DATABASE SuperSportSneakers
GO
USE SuperSportSneakers
GO
--- SAN PHAM
CREATE TABLE SANPHAM 
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	MaSP VARCHAR(15)  NOT NULL ,
	TenSP NVARCHAR(50) NOT NULL,
	NgayTao DATE DEFAULT GETDATE(),
	TrangThai INT DEFAULT 0 NOT NULL --- 0 - Đang Kinh Kinh Doanh 1 - Ngừng Kinh Doanh 2 - Tạm Hết Hàng
	CONSTRAINT PK_SANPHAM PRIMARY KEY (ID)
)
--- THEM SANPHAM
INSERT INTO SANPHAM (MaSP, TenSP)
VALUES 
('SP00001', 'Nike Air Force 1'),
('SP00002', 'Adidas Superstar'),
('SP00003', 'Converse Chuck Taylor'),
('SP00004', 'Vans Old Skool'),
('SP00005', 'Puma Suede');
SELECT * FROM SANPHAM;

CREATE TABLE THUONGHIEU 
(
	 ID BIGINT IDENTITY (1,1) NOT NULL,
	 MaThuongHieu VARCHAR(15)  NOT NULL ,
	 TenThuongHieu NVARCHAR(50) NOT NULL,
     TrangThai INT DEFAULT 0 NOT NULL , -- 0 ĐANG HỢP TÁC , 1 NGỪNG HỢP TÁC
	 CONSTRAINT PK_THUONGHIEU PRIMARY KEY (ID)
)
-- THEM THUONG HIEU
INSERT INTO THUONGHIEU (MaThuongHieu, TenThuongHieu)
VALUES 
('TH001', 'Nike'),
('TH002', 'Adidas'),
('TH003', 'Converse'),
('TH004', 'Vans'),
('TH005', 'Puma');
SELECT * FROM THUONGHIEU

--- MAU
CREATE TABLE MAU 
(
	 ID BIGINT IDENTITY (1,1) NOT NULL,
	 MaMau VARCHAR(15)  NOT NULL ,
	 TenMau NVARCHAR(50) NOT NULL,
     TrangThai INT DEFAULT 0 NOT NULL , -- 0 CÒN DÙNG , 1 KHÔNG DÙNG
	 CONSTRAINT PK_MAU PRIMARY KEY (ID)
)
INSERT INTO MAU (MaMau, TenMau )
VALUES 
('MAU0001', 'Đỏ'),
('MAU0002', 'Xanh'),
('MAU0003', 'Trắng'),
('MAU0004', 'Vàng'),
('MAU0005', 'Đen');

--- SIZE 
CREATE TABLE SIZE 
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	MaSize VARCHAR(15)  NOT NULL ,
	TenSize DECIMAL(3, 1) NOT NULL,
    TrangThai INT DEFAULT 0 NOT NULL -- 0 CÒN DÙNG , 1 KHÔNG DÙNG
	CONSTRAINT PK_SIZE PRIMARY KEY (ID)
)
-- them SIZE
INSERT INTO SIZE (MaSize, TenSize)
VALUES 
('KT001', 34.5),
('KT002', 35),
('KT003', 35.5),
('KT004', 36),
('KT005', 36.5),
('KT006', 37),
('KT007', 37.5),
('KT008', 38),
('KT009', 38.5),
('KT010', 39);

-- ĐỢT GIẢM GIÁ
CREATE TABLE DOT_GIAM_GIA 
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	MaDGG VARCHAR(10)  NULL ,
	TenDGG NVARCHAR(100) NULL,
	Loai BIT  NULL ,--- 0 LÀ % 1 LÀ VND
	GiaTri int NULL,
	NgayBatDau DATETIME NULL,
	NgayKetThuc DATETIME NULL,
	MoTa NVARCHAR(250) NULL,
	NgayTao DATE DEFAULT GETDATE(),
	TrangThai INT NULL , ---0 SẮP ĐẾN , 1 ĐANG ĐƯỢC ÁP DỤNG , 2 KẾT THÚC ĐỢT GIẢM GIÁ 
	CONSTRAINT PK_DOT_GIAM_GIA PRIMARY KEY (ID),
)
SELECT * FROM DOT_GIAM_GIA
--- THEM ĐỢT GIẢM GIÁ 

INSERT INTO DOT_GIAM_GIA (MaDGG, Loai, GiaTri, NgayBatDau, NgayKetThuc, MoTa, NgayTao, TrangThai)
VALUES 
('DGG001', 0, 10, '2023-11-15 00:00:00', '2023-11-20 23:59:59', 'Giảm giá 10% cho sản phẩm', GETDATE(), 0),
('DGG002', 1, 50000, '2023-11-25 12:00:00', '2023-11-30 23:59:59', 'Giảm giá 50,000 VND cho sản phẩm', GETDATE(), 0),
('DGG003', 0, 15, '2023-12-05 00:00:00', '2023-12-10 23:59:59', 'Giảm giá 15% cho sản phẩm', GETDATE(), 0),
('DGG004', 1, 100000, '2023-12-15 12:00:00', '2023-12-20 23:59:59', 'Giảm giá 100,000 VND cho sản phẩm', GETDATE(), 0),
('DGG005', 0, 20, '2023-12-25 00:00:00', '2023-12-30 23:59:59', 'Giảm giá 20% cho sản phẩm', GETDATE(), 0);


--- CHI TIẾT SẢN PHẨM
CREATE TABLE CHI_TIET_SAN_PHAM
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	IdSP BIGINT NOT NULL ,
	IdThuongHieu BIGINT NOT NULL,
	IdMau BIGINT NOT NULL,
	IdSize BIGINT NOT NULL,
	IdDGG BIGINT NULL,
	MaCTSP VARCHAR(15) NOT NULL,
	SoLuongTon INT NOT NULL ,
	GiaNiemYet MONEY NOT NULL , -- ÁNH XẠ JAVA => BigDecimal
	GiaBan MONEY NOT NULL,
	Anh VARCHAR (250) NOT NULL ,
	MoTa NVARCHAR(500) ,
	NgayTao DATE DEFAULT GETDATE(),
	TrangThai INT NOT NULL DEFAULT 0 , -- 0 CÒN HÀNG , 1 TẠM HẾT , 2 DỪNG BÁN
	CONSTRAINT PK_CHI_TIET_SAN_PHAM PRIMARY KEY (ID),
	CONSTRAINT FK_CHI_TIET_SAN_PHAM_SANPHAM FOREIGN KEY (IdSP) REFERENCES SANPHAM (ID),
	CONSTRAINT FK_CHI_TIET_SAN_PHAM_THUONGHIEU FOREIGN KEY (IdThuongHieu) REFERENCES THUONGHIEU (ID),
	CONSTRAINT FK_CHI_TIET_SAN_PHAM_MAU FOREIGN KEY (IdMau) REFERENCES MAU (ID),
	CONSTRAINT FK_CHI_TIET_SAN_PHAM_SIZE FOREIGN KEY (IdSize) REFERENCES SIZE (ID),
	CONSTRAINT FK_CHI_TIET_SAN_PHAM_DOT_GIAM_GIA FOREIGN KEY (IdDGG) REFERENCES DOT_GIAM_GIA (ID),
)
--- THEM CHI TIET SAN PHAM
INSERT INTO CHI_TIET_SAN_PHAM (IdSP, IdThuongHieu, IdMau, IdSize, MaCTSP, SoLuongTon, GiaNiemYet, GiaBan, Anh, NgayTao, TrangThai)
VALUES 
(1, 1, 1, 1, 'CTSP0001', 50, 1200000.00, 1200000.00, 'nike_air_force_1.jpg', GETDATE(), 0),
(2, 2, 2, 2, 'CTSP0002', 30, 1100000.00, 1100000.00, 'adidas_superstar.jpg', GETDATE(), 0),
(3, 3, 3, 3, 'CTSP0003', 20, 1000000.00, 1000000.00, 'converse_chuck_taylor.jpg', GETDATE(), 0),
(4, 4, 4, 4, 'CTSP0004', 25, 1050000.00, 1050000.00, 'vans_old_skool.jpg', GETDATE(), 0),
(5, 5, 5, 5, 'CTSP0005', 40, 1150000.00, 1150000.00, 'puma_suede.jpg', GETDATE(), 0);

SELECT * FROM CHI_TIET_SAN_PHAM



CREATE TABLE NHANVIEN 
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	MaNhanVien VARCHAR(10)  NULL,
	HoVaTen NVARCHAR(50) NULL,
	MatKhau VARCHAR(10) NULL,
	NgaySinh DATE NULL,
	CCCD VARCHAR(12) NULL ,
	Email VARCHAR(50) NULL,
	DiaChi NVARCHAR(100) NULL,
	SDT VARCHAR(15) NULL,
	VaiTro BIT  DEFAULT 0 ,--- 0 NHÂN VIÊN , 1 LÀ QUẢN LÍ
	NgayTao DATE DEFAULT GETDATE(),
	TrangThai BIT DEFAULT 1 , -- 0 ĐÃ NGHỈ 1 ĐANG LÀM
	CONSTRAINT PK_NHANVIEN PRIMARY KEY (ID),
)
--- THEM NHAN VIEN
-- Thêm 10 nhân viên vào NHANVIEN
INSERT INTO NHANVIEN (MaNhanVien, HoVaTen, MatKhau, NgaySinh, CCCD, Email, DiaChi, SDT, VaiTro, NgayTao, TrangThai)
VALUES 
('NV001', N'Nguyễn Văn A', 'pass123', '1990-01-15', '123456789012', 'nva@example.com', N'123 Đường ABC, Quận XYZ', '0901234567', 0, GETDATE(), 1),
('NV002', N'Trần Thị B', 'pass456', '1995-05-20', '234567890123', 'ttb@example.com', N'456 Đường DEF, Quận LMN', '0912345678', 0, GETDATE(), 1),
('NV003', N'Phạm Văn C', 'pass789', '1988-08-10', '345678901234', 'pvc@example.com', N'789 Đường GHI, Quận OPQ', '0923456789', 0, GETDATE(), 1),
('NV004', N'Lê Thị D', 'passABC', '1992-12-25', '456789012345', 'ltd@example.com', N'101 Đường JKL, Quận RST', '0934567890', 0, GETDATE(), 1),
('NV005', N'Ngô Văn E', 'passDEF', '1985-04-30', '567890123456', 'nve@example.com', N'202 Đường UVW, Quận XYZ', '0945678901', 0, GETDATE(), 1),
('NV006', N'Lý Thị F', 'passGHI', '1998-07-05', '678901234567', 'ltf@example.com', N'303 Đường LMN, Quận OPQ', '0956789012', 0, GETDATE(), 1),
('NV007', N'Nguyễn Văn Mạnh', 'passLMN', '1980-11-12', '789012345678', 'hvm@example.com', N'404 Đường OPQ, Quận RST', '0967890123', 1, GETDATE(), 1),
('NV008', N'Tạ Bá Hòa', 'passOPQ', '1983-09-18', '890123456789', 'tbh@example.com', N'505 Đường RST, Quận UVW', '0978901234', 1, GETDATE(), 1),
('NV009', N'Trương Văn I', 'passRST', '1993-03-08', '901234567890', 'tvi@example.com', N'606 Đường XYZ, Quận ABC', '0989012345', 0, GETDATE(), 1),
('NV010', N'Vũ Thị K', 'passUVW', '1996-06-22', '012345678901', 'vtk@example.com', N'707 Đường ABC, Quận DEF', '0990123456', 0, GETDATE(), 1);


SELECT * FROM NHANVIEN

CREATE TABLE KHACHHANG
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	MaKhachHang VARCHAR(20) NULL,
	TenKhachHang NVARCHAR(50) NULL,
	SDT VARCHAR(15) NOT NULL,
	NgaySinh DATE NULL,
	GioiTinh BIT NULL , --- 0  NU , 1 NAM
	DiaChi NVARCHAR(100) NULL,
	Diem INT DEFAULT 0 ,
	CapBac INT DEFAULT 0 , -- O DONG 1 BAC 2 VANG 
	NgayTao DATE DEFAULT GETDATE(),
	TrangThai BIT DEFAULT 1 , --- 1 CÒN HOẠT ĐỘNG 0 DÙNG HOẶT ĐỌNG
	CONSTRAINT PK_KHACHHANG PRIMARY KEY (ID) 
)


--- THEM KHACH HANG

-- Thêm 10 khách hàng vào KHACHHANG
INSERT INTO KHACHHANG (MaKhachHang, TenKhachHang, SDT, NgaySinh, GioiTinh, DiaChi, Diem, CapBac, NgayTao, TrangThai)
VALUES 
('KH001', N'Nguyễn Văn Khách 1', '0901234561', '1990-01-15', 1, N'123 Đường ABC, Quận XYZ', 50, 1, GETDATE(), 1),
('KH002', N'Trần Thị Khách 2', '0912345672', '1995-05-20', 0, N'456 Đường DEF, Quận LMN', 30, 0, GETDATE(), 1),
('KH003', N'Phạm Văn Khách 3', '0923456783', '1988-08-10', 1, N'789 Đường GHI, Quận OPQ', 20, 2, GETDATE(), 1),
('KH004', N'Lê Thị Khách 4', '0934567894', '1992-12-25', 0, N'101 Đường JKL, Quận RST', 25, 1, GETDATE(), 1),
('KH005', N'Ngô Văn Khách 5', '0945678905', '1985-04-30', 1, N'202 Đường UVW, Quận XYZ', 40, 0, GETDATE(), 1),
('KH006', N'Lý Thị Khách 6', '0956789016', '1998-07-05', 0, N'303 Đường LMN, Quận OPQ', 35, 1, GETDATE(), 1),
('KH007', N'Hồ Văn Khách 7', '0967890127', '1980-11-12', 1, N'404 Đường OPQ, Quận RST', 60, 2, GETDATE(), 1),
('KH008', N'Đinh Thị Khách 8', '0978901238', '1983-09-18', 0, N'505 Đường RST, Quận UVW', 45, 0, GETDATE(), 1),
('KH009', N'Trương Văn Khách 9', '0989012349', '1993-03-08', 1, N'606 Đường XYZ, Quận ABC', 55, 1, GETDATE(), 1),
('KH010', N'Vũ Thị Khách 10', '0990123450', '1996-06-22', 0, N'707 Đường ABC, Quận DEF', 70, 2, GETDATE(), 1);


SELECT * FROM KHACHHANG

--- PHIEU GIAM GIA

CREATE TABLE PHIEU_GIAM_GIA 
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	MaPhieu NVARCHAR(20) NULL ,
	TenPhieu NVARCHAR(100) NULL,
	LoaiPhieu BIT NULL , -- 0 LÀ % , 1 VND
	GiaTri BIGINT NULL , -- ÁNH XẠ JAVA => Long
	SoLuongPhieu INT NULL,
	DonToiThieu MONEY NULL , --- ÁNH XẠ JAVA => BigDecimal
	NgayBatDau DATETIME NULL,
	NgayKetThuc DATETIME NULL,
	MoTa NVARCHAR(250) NULL,
	TrangThai INT NULL , -- 0 SẮP ĐẾN , 1 ĐANG DIỄN RA , 2 ĐÃ KẾT THÚC
	CONSTRAINT PK_PHIEU_GIAM_GIA PRIMARY KEY (ID)
)

-- THEM PHIEU GIAM GIÁ
INSERT INTO PHIEU_GIAM_GIA (MaPhieu, TenPhieu, LoaiPhieu, GiaTri, SoLuongPhieu, DonToiThieu, NgayBatDau, NgayKetThuc, MoTa, TrangThai)
VALUES 
('PGG001', N'Phiếu Giảm Giá 1', 0, 10, 100, 50000.00, '2023-06-01 00:00:00', '2023-06-10 23:59:59', N'Hóa đơn trên 500.000 sẽ được giảm 10%', 0),
('PGG002', N'Phiếu Giảm Giá 2', 1, 150000, 30, 700000.00, '2023-06-01 00:00:00', '2023-06-10 23:59:59', N'Hóa đơn trên 700000 sẽ được giảm 150.000 VND', 0),
('PGG003', N'Phiếu Giảm Giá 3', 0, 20, 200, 80000.00, '2023-07-01 00:00:00', '2023-07-10 23:59:59', N'Hóa đơn trên 80000 sẽ được giảm 20%', 1),
('PGG004', N'Phiếu Giảm Giá 4', 1, 250000, 25, 1200000.00, '2023-07-01 00:00:00', '2023-07-10 23:59:59', N'Hóa đơn trên 1200000 sẽ được giảm 250000 VND', 1),
('PGG005', N'Phiếu Giảm Giá 5', 0, 30, 300, 100000.00, '2023-08-01 00:00:00', '2023-08-10 23:59:59', N'Hóa đơn trên 100000 sẽ được giảm 30%', 2),
('PGG006', N'Phiếu Giảm Giá 6', 1, 300000, 20, 1500000.00, '2023-08-01 00:00:00', '2023-08-10 23:59:59', N'Hóa đơn trên 1500000 sẽ được giảm 300.000 VND', 2),
('PGG007', N'Phiếu Giảm Giá 7', 0, 25, 250, 90000.00, '2023-09-01 00:00:00', '2023-09-10 23:59:59', N'Hóa đơn trên 900.000 sẽ được giảm 25%', 1),
('PGG008', N'Phiếu Giảm Giá 8', 1, 400000, 15, 1800000.00, '2023-09-01 00:00:00', '2023-09-10 23:59:59', N'Hóa đơn trên 1800000 sẽ được giảm 400000 VND', 1),
('PGG009', N'Phiếu Giảm Giá 9', 0, 35, 350, 110000.00, '2023-10-01 00:00:00', '2023-10-10 23:59:59', N'Hóa đơn trên 110000 sẽ được giảm 35%', 0),
('PGG010', N'Phiếu Giảm Giá 10', 1, 500000, 10, 2000000.00, '2023-10-01 00:00:00', '2023-10-10 23:59:59', N'Hóa đơn trên 2000000 sẽ được giảm 500000 VND', 0);

SELECT * FROM PHIEU_GIAM_GIA

CREATE TABLE HOADON
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	IdPGG BIGINT  NULL,
	IdNV BIGINT NOT NULL,
	IdKH BIGINT NOT NULL,
	MaHoaDon VARCHAR(20) NOT NULL,
	PhanTramGia INT NULL , --- CẤP BẬC + PHIẾU THEO %
	TienPhieuGiam MONEY NULL ,-- TIỀN GIẢM THEO PHIẾU VND
	DiemDoi INT NULL, -- tiền khách hàng từ đó lấy ra tiền 1 diem = 10k
	PhuongThucTT int , -- 0 là tại quầy , 1 chuyển khoản ,2  có thể làm kết hợp 2 loại(Có thể bỏ)
	TienKhDua MONEY NULL,
	TienKhChuyenKhoan MONEY NULL,
	TienThua MONEY NULL,
	ThanhTien MONEY NULL,
	NgayTao DATE DEFAULT GETDATE(),
	NgayThanhToan DATETIME NULL,
	TrangThai INT NULL , -- 0 CHƯA TT , 1 ĐÃ THANH TOÁN , 2 ĐANG GIAO ....
	CONSTRAINT PK_HOADON PRIMARY KEY (ID),
	CONSTRAINT FK_HOADON_PHIEU_GIAM_GIA FOREIGN KEY (IdPGG) REFERENCES PHIEU_GIAM_GIA(ID) ,
	CONSTRAINT FK_HOADON_NHANVIEN FOREIGN KEY (IdNV) REFERENCES NHANVIEN (ID),
	CONSTRAINT FK_HOADON_KHACHHANG FOREIGN KEY (IdKH) REFERENCES KHACHHANG (ID),
)
--SELECT * FROM PHIEU_GIAM_GIA
--SELECT * FROM NHANVIEN
--SELECT * FROM KHACHHANG
--SELECT * FROM HOADON

--- HÓA ĐƠN CHI TIẾT

CREATE TABLE HOADONCHITIET
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	IdHoaDon BIGINT NOT NULL ,
	IdCTSP BIGINT NOT NULL,
	SoLuong INT NULL,
	MaDGG VARCHAR(10)  NULL ,
	LoaiDGG BIT NULL,
	GiaTriDGG INT  NULL,
	QuyDoiDGGTT MONEY NULL , -- => ĐỀU QUY RA THÀNH vnd THEO SẢN PHẨM
	GiaBan MONEY NULL,
	DonGia MONEY NULL,
	NgayTao DATETIME DEFAULT GETDATE(),
	TrangThai INT NULL ,
	CONSTRAINT PK_HOADONCHITIET PRIMARY KEY (ID),
	CONSTRAINT FK_HOADONCHITIET_HOADON FOREIGN KEY (IdHoaDon) REFERENCES HOADON  (ID),
	CONSTRAINT FK_HOADONCHITIET_CHI_TIET_SAN_PHAM FOREIGN KEY (IdCTSP) REFERENCES CHI_TIET_SAN_PHAM (ID)
)
--SELECT * FROM CHI_TIET_SAN_PHAM


--- PHIEU GIAO HÀNG
CREATE TABLE PHIEUGIAOHANG
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	IdHoaDon BIGINT NOT NULL,
	TenNguoiNhan NVARCHAR(50)  NULL,
	SDTNguoiNhan VARCHAR(15)  NULL,
	DiaChi NVARCHAR(100)  NULL,
	TenShip NVARCHAR(50)  NULL,
	SDTShip VARCHAR(15)  NULL,
	GiaShip MONEY NULL , ---->ÁNH XẠ JAVA => BigDecimal
	NgayTaoPhieu DATETIME DEFAULT GETDATE(),
	MaVanDon VARCHAR(20) NULL,
	ĐonViVanChuyen NVARCHAR(100) NULL,
	NgayHoanThanhDon DATETIME NULL,
	TrangThai INT DEFAULT 0 , --0 ĐANG ĐANG TẠO, 1  CHỜ GIAO, 2 : ĐẾN NGÀY THÌ TRỜ GIAO HÀNG , 3 : DANG GIAO , 4 : LÀ HẸN LẠI (UPDATE LẠI THÁNG THÁI NGÀY)
	CONSTRAINT PK_PHIEUGIAOHANG PRIMARY KEY (ID),
	CONSTRAINT FKPHIEUGIAOHANG_HOADON FOREIGN KEY (IdHoaDon) REFERENCES HOADON  (ID),
)
SELECT * FROM PHIEUGIAOHANG
---- CHI TIẾT PHIẾU GIAO

CREATE TABLE CHI_TIET_PHIEU_GIAO
(
	ID BIGINT IDENTITY (1,1) NOT NULL,
	IdCTSP BIGINT NULL,
	IdPGH BIGINT NULL ,
	SoLuong INT NULL ,
	CONSTRAINT PK_CHI_TIET_PHIEU_GIAO PRIMARY KEY (ID),
	CONSTRAINT FK_CHI_TIET_PHIEU_GIAO_PHIEUGIAOHANG FOREIGN KEY (IdPGH) REFERENCES PHIEUGIAOHANG(ID),
	CONSTRAINT FK_CHI_TIET_PHIEU_GIAO_CHI_TIET_SAN_PHAM FOREIGN KEY (IdCTSP) REFERENCES CHI_TIET_SAN_PHAM(ID),
)
--SELECT * FROM CHI_TIET_PHIEU_GIAO

--SELECT * FROM CHI_TIET_PHIEU_GIAO
SELECT * FROM CHI_TIET_SAN_PHAM
